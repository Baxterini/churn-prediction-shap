{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "13362f00-e026-43da-9b69-a17eb1f4952a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "=== Threshold tuning (test set) ===\n",
      " threshold  precision   recall       f1  positives_predicted  roc_auc\n",
      "      0.05   0.203203 0.997543 0.337630                 1998 0.777165\n",
      "      0.10   0.207143 0.997543 0.343050                 1960 0.777165\n",
      "      0.15   0.216874 0.985258 0.355496                 1849 0.777165\n",
      "      0.20   0.231757 0.975430 0.374528                 1713 0.777165\n",
      "      0.25   0.250810 0.950860 0.396923                 1543 0.777165\n",
      "      0.30   0.272064 0.916462 0.419573                 1371 0.777165\n",
      "      0.35   0.295868 0.879607 0.442795                 1210 0.777165\n",
      "      0.40   0.326336 0.840295 0.470103                 1048 0.777165\n",
      "      0.45   0.357631 0.771499 0.488716                  878 0.777165\n",
      "      0.50   0.387228 0.700246 0.498688                  736 0.777165\n",
      "      0.55   0.422512 0.636364 0.507843                  613 0.777165\n",
      "      0.60   0.464213 0.557740 0.506696                  489 0.777165\n",
      "      0.65   0.502577 0.479115 0.490566                  388 0.777165\n",
      "      0.70   0.525597 0.378378 0.440000                  293 0.777165\n",
      "      0.75   0.521951 0.262899 0.349673                  205 0.777165\n",
      "      0.80   0.558824 0.186732 0.279926                  136 0.777165\n",
      "      0.85   0.609756 0.122850 0.204499                   82 0.777165\n",
      "      0.90   0.666667 0.054054 0.100000                   33 0.777165\n",
      "      0.95   0.750000 0.007371 0.014599                    4 0.777165\n",
      "\n",
      "=== Best threshold by F1 ===\n",
      "threshold                0.550000\n",
      "precision                0.422512\n",
      "recall                   0.636364\n",
      "f1                       0.507843\n",
      "positives_predicted    613.000000\n",
      "roc_auc                  0.777165\n",
      "\n",
      "--- Confusion matrix @ threshold=0.50 (baseline) ---\n",
      "[[1142  451]\n",
      " [ 122  285]]\n",
      "\n",
      "--- Confusion matrix @ threshold=0.55 (best F1) ---\n",
      "[[1239  354]\n",
      " [ 148  259]]\n",
      "\n",
      "=== Best threshold for recall >= 0.85 (max precision) ===\n",
      "threshold                 0.350000\n",
      "precision                 0.295868\n",
      "recall                    0.879607\n",
      "f1                        0.442795\n",
      "positives_predicted    1210.000000\n",
      "roc_auc                   0.777165\n",
      "\n",
      "--- Confusion matrix @ threshold=0.35 (recall target) ---\n",
      "[[741 852]\n",
      " [ 49 358]]\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "threshold_tuning.py\n",
    "Cel: sprawdzić jak zmieniają się metryki, gdy zmieniamy próg decyzji (threshold).\n",
    "\n",
    "Dlaczego to ważne?\n",
    "- Model zwraca prawdopodobieństwo churn (0..1)\n",
    "- Threshold decyduje, kiedy mówimy \"churn=1\"\n",
    "- W bankowości threshold to strategia biznesowa (recall vs precision)\n",
    "\"\"\"\n",
    "\n",
    "from pathlib import Path\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import joblib\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import (\n",
    "    roc_auc_score,\n",
    "    precision_score,\n",
    "    recall_score,\n",
    "    f1_score,\n",
    "    confusion_matrix,\n",
    ")\n",
    "\n",
    "DATA_PATH = Path(\"data/churn.csv\")\n",
    "MODEL_PATH = Path(\"models/churn_pipeline.joblib\")\n",
    "\n",
    "\n",
    "def load_data() -> tuple[pd.DataFrame, pd.Series]:\n",
    "    df = pd.read_csv(DATA_PATH)\n",
    "\n",
    "    # usuwamy kolumny techniczne/ID\n",
    "    drop_cols = [\"RowNumber\", \"CustomerId\", \"Surname\"]\n",
    "    X = df.drop(columns=drop_cols + [\"Exited\"], errors=\"ignore\")\n",
    "    y = df[\"Exited\"].astype(int)\n",
    "    return X, y\n",
    "\n",
    "\n",
    "def metrics_at_threshold(y_true, y_proba, thr: float) -> dict:\n",
    "    \"\"\"\n",
    "    Liczymy metryki dla konkretnego progu.\n",
    "    y_proba: prawdopodobieństwo churnu (klasa 1)\n",
    "    \"\"\"\n",
    "    y_pred = (y_proba >= thr).astype(int)\n",
    "\n",
    "    return {\n",
    "        \"threshold\": thr,\n",
    "        \"roc_auc\": roc_auc_score(y_true, y_proba),  # ROC-AUC nie zależy od threshold\n",
    "        \"precision\": precision_score(y_true, y_pred, zero_division=0),\n",
    "        \"recall\": recall_score(y_true, y_pred, zero_division=0),\n",
    "        \"f1\": f1_score(y_true, y_pred, zero_division=0),\n",
    "        \"cm\": confusion_matrix(y_true, y_pred),\n",
    "        \"positives_predicted\": int(y_pred.sum()),  # ilu klientów oznaczyliśmy jako churn\n",
    "    }\n",
    "\n",
    "\n",
    "def main():\n",
    "    # 1) Dane\n",
    "    X, y = load_data()\n",
    "\n",
    "    # 2) Split identyczny jak w train.py (żeby porównanie było fair)\n",
    "    X_train, X_test, y_train, y_test = train_test_split(\n",
    "        X, y, test_size=0.2, random_state=42, stratify=y\n",
    "    )\n",
    "\n",
    "    # 3) Wczytujemy gotowy model pipeline\n",
    "    if not MODEL_PATH.exists():\n",
    "        raise FileNotFoundError(\n",
    "            f\"Brak modelu: {MODEL_PATH}. Najpierw uruchom: python train.py\"\n",
    "        )\n",
    "\n",
    "    pipe = joblib.load(MODEL_PATH)\n",
    "\n",
    "    # 4) Prawdopodobieństwa churn na teście\n",
    "    y_proba = pipe.predict_proba(X_test)[:, 1]\n",
    "\n",
    "    # 5) Przeglądamy progi\n",
    "    thresholds = np.round(np.linspace(0.05, 0.95, 19), 2)  # 0.05, 0.10, ..., 0.95\n",
    "    rows = []\n",
    "    for thr in thresholds:\n",
    "        rows.append(metrics_at_threshold(y_test, y_proba, thr))\n",
    "\n",
    "    # 6) Tabela wyników (bez confusion matrix w tabeli)\n",
    "    summary = pd.DataFrame(\n",
    "        [\n",
    "            {\n",
    "                \"threshold\": r[\"threshold\"],\n",
    "                \"precision\": r[\"precision\"],\n",
    "                \"recall\": r[\"recall\"],\n",
    "                \"f1\": r[\"f1\"],\n",
    "                \"positives_predicted\": r[\"positives_predicted\"],\n",
    "                \"roc_auc\": r[\"roc_auc\"],\n",
    "            }\n",
    "            for r in rows\n",
    "        ]\n",
    "    )\n",
    "\n",
    "    print(\"\\n=== Threshold tuning (test set) ===\")\n",
    "    print(summary.to_string(index=False))\n",
    "\n",
    "    # 7) Najlepszy próg pod F1 (klasyczny wybór)\n",
    "    best_f1_row = summary.loc[summary[\"f1\"].idxmax()]\n",
    "    best_thr_f1 = float(best_f1_row[\"threshold\"])\n",
    "\n",
    "    print(\"\\n=== Best threshold by F1 ===\")\n",
    "    print(best_f1_row.to_string())\n",
    "\n",
    "    # 8) Pokaż confusion matrix dla:\n",
    "    # - progu 0.50 (baseline)\n",
    "    # - progu najlepszego pod F1\n",
    "    base = next(r for r in rows if r[\"threshold\"] == 0.50)\n",
    "    best = next(r for r in rows if r[\"threshold\"] == best_thr_f1)\n",
    "\n",
    "    print(\"\\n--- Confusion matrix @ threshold=0.50 (baseline) ---\")\n",
    "    print(base[\"cm\"])\n",
    "\n",
    "    print(f\"\\n--- Confusion matrix @ threshold={best_thr_f1:.2f} (best F1) ---\")\n",
    "    print(best[\"cm\"])\n",
    "\n",
    "    # 9) BONUS: próg pod \"wysoki recall\" (np. >= 0.85)\n",
    "    target_recall = 0.85\n",
    "    candidates = summary[summary[\"recall\"] >= target_recall]\n",
    "    if len(candidates) > 0:\n",
    "        # wybieramy taki próg, który ma najwyższy precision przy recall >= target\n",
    "        best_recall_row = candidates.sort_values(\"precision\", ascending=False).iloc[0]\n",
    "        thr_recall = float(best_recall_row[\"threshold\"])\n",
    "        print(f\"\\n=== Best threshold for recall >= {target_recall:.2f} (max precision) ===\")\n",
    "        print(best_recall_row.to_string())\n",
    "\n",
    "        cm_recall = next(r for r in rows if r[\"threshold\"] == thr_recall)[\"cm\"]\n",
    "        print(f\"\\n--- Confusion matrix @ threshold={thr_recall:.2f} (recall target) ---\")\n",
    "        print(cm_recall)\n",
    "    else:\n",
    "        print(f\"\\nNie znaleziono progu dającego recall >= {target_recall:.2f}.\")\n",
    "\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    main()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0d4ff923-b16e-48ab-9dc8-2c779fc46f38",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: scikit-learn in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (1.4.2)\n",
      "Collecting scikit-learn\n",
      "  Downloading scikit_learn-1.8.0-cp311-cp311-win_amd64.whl.metadata (11 kB)\n",
      "Requirement already satisfied: joblib in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (1.3.2)\n",
      "Collecting joblib\n",
      "  Downloading joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)\n",
      "Requirement already satisfied: pandas in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (2.1.4)\n",
      "Collecting pandas\n",
      "  Using cached pandas-2.3.3-cp311-cp311-win_amd64.whl.metadata (19 kB)\n",
      "Requirement already satisfied: numpy in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (1.26.4)\n",
      "Collecting numpy\n",
      "  Downloading numpy-2.4.0-cp311-cp311-win_amd64.whl.metadata (6.6 kB)\n",
      "Requirement already satisfied: scipy>=1.10.0 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from scikit-learn) (1.11.4)\n",
      "Requirement already satisfied: threadpoolctl>=3.2.0 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from scikit-learn) (3.6.0)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from pandas) (2.9.0.post0)\n",
      "Requirement already satisfied: pytz>=2020.1 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from pandas) (2025.2)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from pandas) (2025.2)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\baxiu\\miniconda3\\envs\\od_zera_do_ai\\lib\\site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)\n",
      "Downloading scikit_learn-1.8.0-cp311-cp311-win_amd64.whl (8.1 MB)\n",
      "   ---------------------------------------- 0.0/8.1 MB ? eta -:--:--\n",
      "   ---------------------------------------- 0.0/8.1 MB ? eta -:--:--\n",
      "   - -------------------------------------- 0.3/8.1 MB ? eta -:--:--\n",
      "   - -------------------------------------- 0.3/8.1 MB ? eta -:--:--\n",
      "   -- ------------------------------------- 0.5/8.1 MB 837.5 kB/s eta 0:00:10\n",
      "   --- ------------------------------------ 0.8/8.1 MB 1.0 MB/s eta 0:00:07\n",
      "   ----- ---------------------------------- 1.0/8.1 MB 1.1 MB/s eta 0:00:07\n",
      "   ------ --------------------------------- 1.3/8.1 MB 1.1 MB/s eta 0:00:06\n",
      "   --------- ------------------------------ 1.8/8.1 MB 1.2 MB/s eta 0:00:06\n",
      "   ---------- ----------------------------- 2.1/8.1 MB 1.2 MB/s eta 0:00:05\n",
      "   ---------- ----------------------------- 2.1/8.1 MB 1.2 MB/s eta 0:00:05\n",
      "   ----------- ---------------------------- 2.4/8.1 MB 1.2 MB/s eta 0:00:05\n",
      "   ----------- ---------------------------- 2.4/8.1 MB 1.2 MB/s eta 0:00:05\n",
      "   ------------ --------------------------- 2.6/8.1 MB 1.1 MB/s eta 0:00:05\n",
      "   -------------- ------------------------- 2.9/8.1 MB 1.1 MB/s eta 0:00:05\n",
      "   --------------- ------------------------ 3.1/8.1 MB 1.1 MB/s eta 0:00:05\n",
      "   ---------------- ----------------------- 3.4/8.1 MB 1.1 MB/s eta 0:00:05\n",
      "   ------------------ --------------------- 3.7/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   ------------------- -------------------- 3.9/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   -------------------- ------------------- 4.2/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   -------------------- ------------------- 4.2/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   ---------------------- ----------------- 4.5/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   ----------------------- ---------------- 4.7/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   ----------------------- ---------------- 4.7/8.1 MB 1.1 MB/s eta 0:00:04\n",
      "   ------------------------ --------------- 5.0/8.1 MB 1.1 MB/s eta 0:00:03\n",
      "   ------------------------- -------------- 5.2/8.1 MB 1.1 MB/s eta 0:00:03\n",
      "   --------------------------- ------------ 5.5/8.1 MB 1.1 MB/s eta 0:00:03\n",
      "   ---------------------------- ----------- 5.8/8.1 MB 1.1 MB/s eta 0:00:03\n",
      "   ----------------------------- ---------- 6.0/8.1 MB 1.1 MB/s eta 0:00:02\n",
      "   -------------------------------- ------- 6.6/8.1 MB 1.1 MB/s eta 0:00:02\n",
      "   --------------------------------- ------ 6.8/8.1 MB 1.1 MB/s eta 0:00:02\n",
      "   --------------------------------- ------ 6.8/8.1 MB 1.1 MB/s eta 0:00:02\n",
      "   ----------------------------------- ---- 7.1/8.1 MB 1.1 MB/s eta 0:00:01\n",
      "   ------------------------------------ --- 7.3/8.1 MB 1.1 MB/s eta 0:00:01\n",
      "   ------------------------------------- -- 7.6/8.1 MB 1.1 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 7.9/8.1 MB 1.1 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 8.1/8.1 MB 1.1 MB/s  0:00:07\n",
      "Downloading joblib-1.5.3-py3-none-any.whl (309 kB)\n",
      "Using cached pandas-2.3.3-cp311-cp311-win_amd64.whl (11.3 MB)\n",
      "Installing collected packages: joblib, scikit-learn, pandas\n",
      "\n",
      "  Attempting uninstall: joblib\n",
      "\n",
      "    Found existing installation: joblib 1.3.2\n",
      "\n",
      "    Uninstalling joblib-1.3.2:\n",
      "\n",
      "      Successfully uninstalled joblib-1.3.2\n",
      "\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "  Attempting uninstall: scikit-learn\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "    Found existing installation: scikit-learn 1.4.2\n",
      "   ---------------------------------------- 0/3 [joblib]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "    Uninstalling scikit-learn-1.4.2:\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "      Successfully uninstalled scikit-learn-1.4.2\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "  Attempting uninstall: pandas\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "    Found existing installation: pandas 2.1.4\n",
      "   ------------- -------------------------- 1/3 [scikit-learn]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "    Uninstalling pandas-2.1.4:\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "      Successfully uninstalled pandas-2.1.4\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   -------------------------- ------------- 2/3 [pandas]\n",
      "   ---------------------------------------- 3/3 [pandas]\n",
      "\n",
      "Successfully installed joblib-1.5.3 pandas-2.3.3 scikit-learn-1.8.0\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
      "category-encoders 2.7.0 requires scikit-learn<1.6.0,>=1.0.0, but you have scikit-learn 1.8.0 which is incompatible.\n",
      "pycaret 3.3.2 requires joblib<1.4,>=1.2.0, but you have joblib 1.5.3 which is incompatible.\n",
      "pycaret 3.3.2 requires pandas<2.2.0, but you have pandas 2.3.3 which is incompatible.\n",
      "sktime 0.26.0 requires pandas<2.2.0,>=1.1, but you have pandas 2.3.3 which is incompatible.\n",
      "sktime 0.26.0 requires scikit-learn<1.5.0,>=0.24, but you have scikit-learn 1.8.0 which is incompatible.\n"
     ]
    }
   ],
   "source": [
    "pip install -U scikit-learn joblib pandas numpy\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
